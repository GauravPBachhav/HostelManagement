<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <title>Admin Dashboard - Hostel Management</title>
  <meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/>
  <style>
    *{box-sizing:border-box;}
    body{font-family:Arial,sans-serif;margin:0;background:#f0f2f5;display:flex;flex-direction:column;min-height:100vh;}
    main{flex:1;}
    .page-header{background:white;padding:20px 30px;border-bottom:1px solid #eee;display:flex;align-items:center;gap:14px;}
    .page-header .avatar{width:46px;height:46px;background:#1a252f;border-radius:50%;color:white;display:flex;align-items:center;justify-content:center;font-size:20px;}
    .page-header h2{margin:0;font-size:20px;color:#1a252f;}
    .page-header p{margin:2px 0 0;font-size:13px;color:#888;}

    /* ====== HORIZONTAL TAB BAR ====== */
    .tab-bar{
      display:flex;overflow-x:auto;background:white;
      border-bottom:2px solid #eee;padding:0 20px;
      white-space:nowrap;
    }
    .tab-bar::-webkit-scrollbar{height:4px;}
    .tab-bar::-webkit-scrollbar-thumb{background:#ddd;border-radius:4px;}
    .tab-bar a{
      display:inline-block;padding:14px 20px;text-decoration:none;
      color:#888;font-size:14px;font-weight:bold;
      border-bottom:3px solid transparent;transition:color 0.2s;
    }
    .tab-bar a:hover{color:#3498db;}
    .tab-bar a.tab-active{color:#3498db;border-bottom:3px solid #3498db;}

    /* ====== TAB SECTIONS ====== */
    .tab-content{max-width:1100px;margin:25px auto;padding:0 15px;}
    .section-panel{display:none;}
    .section-panel:target{display:block;}
    .section-panel.default-show{display:block;}

    .card{background:white;border-radius:12px;padding:24px;margin-bottom:20px;box-shadow:0 2px 10px rgba(0,0,0,0.08);}
    .card h3{margin:0 0 18px;color:#1a252f;font-size:16px;border-bottom:1px solid #f0f2f5;padding-bottom:10px;}

    /* Table */
    table{width:100%;border-collapse:collapse;font-size:13px;}
    thead th{background:#1a252f;color:white;padding:10px 12px;text-align:left;font-weight:600;}
    tbody td{padding:10px 12px;border-bottom:1px solid #f0f2f5;color:#444;}
    tbody tr:last-child td{border-bottom:none;}
    tbody tr:hover td{background:#fafafa;}

    /* Detail row inside table */
    .detail-row td{background:#f8f9fa!important;font-size:12px;color:#666;padding:6px 12px;}

    /* Badges */
    .badge{display:inline-block;padding:4px 10px;border-radius:12px;font-size:11px;font-weight:bold;}
    .badge-pending {background:#fff3cd;color:#856404;}
    .badge-approved{background:#d4edda;color:#155724;}
    .badge-rejected{background:#f8d7da;color:#721c24;}

    /* Buttons */
    .btn{padding:5px 14px;border:none;border-radius:20px;cursor:pointer;font-size:12px;font-weight:bold;color:white;}
    .btn-approve{background:#27ae60;}
    .btn-reject {background:#e74c3c;}
    .btn:hover{opacity:0.85;}

    .no-data{text-align:center;padding:30px;color:#bbb;font-size:15px;}
    .alert{padding:11px 16px;border-radius:8px;margin-bottom:16px;font-size:14px;}
    .alert-success{background:#d4edda;color:#155724;}
  </style>
</head>
<body>
<div th:replace="fragments/header :: header"></div>
<main>

  <div class="page-header">
    <div class="avatar">‚öôÔ∏è</div>
    <div>
      <h2>Admin Dashboard</h2>
      <p>Manage student admissions, approvals and rent.</p>
    </div>
  </div>

  <!-- ====== HORIZONTAL ADMIN TAB BAR ====== -->
  <div class="tab-bar">
    <a href="#tab-pending"  class="tab-active">‚è≥ Pending (<span th:text="${#lists.size(pendingProfiles)}">0</span>)</a>
    <a href="#tab-approved">‚úÖ Approved (<span th:text="${#lists.size(approvedProfiles)}">0</span>)</a>
    <a href="#tab-rejected">‚ùå Rejected (<span th:text="${#lists.size(rejectedProfiles)}">0</span>)</a>
  </div>

  <div class="tab-content">

    <!-- Flash message -->
    <div th:if="${success}" class="alert alert-success" th:text="${success}"></div>

    <!-- ====== TAB 1: PENDING ‚Äî WITH FULL DETAILS + APPROVE/REJECT ====== -->
    <div id="tab-pending" class="section-panel default-show">
      <div class="card">
        <h3>‚è≥ Pending Admissions ‚Äî Review &amp; Approve</h3>
        <div th:if="${#lists.isEmpty(pendingProfiles)}" class="no-data">üéâ No pending admissions right now.</div>
        <table th:unless="${#lists.isEmpty(pendingProfiles)}">
          <thead>
            <tr>
              <th>#</th>
              <th>Name</th><th>Email</th>
              <th>Phone</th><th>College</th>
              <th>Course</th><th>Year</th>
              <th>Address</th>
              <th>Parent</th><th>Parent Contact</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            <tr th:each="p, s : ${pendingProfiles}">
              <td th:text="${s.count}"></td>
              <td><strong th:text="${p.user != null ? p.user.name  : '-'}"></strong></td>
              <td th:text="${p.user != null ? p.user.email : '-'}"></td>
              <td th:text="${p.phoneNumber}"></td>
              <td th:text="${p.collegeName}"></td>
              <td th:text="${p.course}"></td>
              <td th:text="${p.yearOfStudy}"></td>
              <td th:text="${p.address}"></td>
              <td th:text="${p.parentName}"></td>
              <td th:text="${p.parentContact}"></td>
              <td>
                <form th:action="@{/admin/approve/{id}(id=${p.id})}" method="post" style="display:inline;">
                  <button type="submit" class="btn btn-approve">‚úÖ Approve</button>
                </form>
                <form th:action="@{/admin/reject/{id}(id=${p.id})}"  method="post" style="display:inline;margin-left:4px;">
                  <button type="submit" class="btn btn-reject">‚ùå Reject</button>
                </form>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- ====== TAB 2: APPROVED ====== -->
    <div id="tab-approved" class="section-panel">
      <div class="card">
        <h3>‚úÖ Approved Students</h3>
        <div th:if="${#lists.isEmpty(approvedProfiles)}" class="no-data">No approved students yet.</div>
        <table th:unless="${#lists.isEmpty(approvedProfiles)}">
          <thead>
            <tr><th>#</th><th>Name</th><th>Email</th><th>College</th><th>Course</th><th>Phone</th><th>Status</th></tr>
          </thead>
          <tbody>
            <tr th:each="p, s : ${approvedProfiles}">
              <td th:text="${s.count}"></td>
              <td><strong th:text="${p.user != null ? p.user.name  : '-'}"></strong></td>
              <td th:text="${p.user != null ? p.user.email : '-'}"></td>
              <td th:text="${p.collegeName}"></td>
              <td th:text="${p.course}"></td>
              <td th:text="${p.phoneNumber}"></td>
              <td><span class="badge badge-approved">‚úÖ Approved</span></td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- ====== TAB 3: REJECTED ====== -->
    <div id="tab-rejected" class="section-panel">
      <div class="card">
        <h3>‚ùå Rejected Students</h3>
        <div th:if="${#lists.isEmpty(rejectedProfiles)}" class="no-data">No rejected students.</div>
        <table th:unless="${#lists.isEmpty(rejectedProfiles)}">
          <thead>
            <tr><th>#</th><th>Name</th><th>Email</th><th>College</th><th>Course</th><th>Phone</th><th>Status</th></tr>
          </thead>
          <tbody>
            <tr th:each="p, s : ${rejectedProfiles}">
              <td th:text="${s.count}"></td>
              <td><strong th:text="${p.user != null ? p.user.name  : '-'}"></strong></td>
              <td th:text="${p.user != null ? p.user.email : '-'}"></td>
              <td th:text="${p.collegeName}"></td>
              <td th:text="${p.course}"></td>
              <td th:text="${p.phoneNumber}"></td>
              <td><span class="badge badge-rejected">‚ùå Rejected</span></td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

  </div>
</main>
<div th:replace="fragments/footer :: footer"></div>
</body>
</html>
